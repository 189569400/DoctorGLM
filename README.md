<p align="center">
  <img src="imgs/logo.png" width=400px/>
  <br/>
  <img src="https://img.shields.io/badge/Version-0.0.1--alpha-brightgreen">
</p>


# DoctorGLM
中文问诊模型， 基于 ChatGLM-6B + lora 进行finetune

finetune代码来自 https://github.com/ssbuild/chatglm_finetuning
## 训练数据
https://github.com/Toyhom/Chinese-medical-dialogue-data
## 准备
- 显存 >= 13G
- pip install deep_training cpm_kernels icetk transformers>=4.26.1 
- torch >= 1.12.0 (icetk依赖cpu版torch, 建议先安装icetk后安装gpu版torch)
## 使用
直接使用Doctor_GLM/chat.ipynb


第一次运行会下载chatGLM-6B权重
## 对话示例
"0": {
        "question": "癫痫病的检查方法是什么呢",
        "response": "癫痫是一种神经系统疾病，其症状包括癫痫发作和癫痫持续状态。癫痫发作是指大脑神经元突然停止放电，导致患者出现癫痫症状，如意识丧失、口胡、头痛、视觉障碍等。而癫痫持续状态是指大脑神经元的放电现象无法被控制，患者可能出现严重的症状，如意识丧失、呼吸停止、肌肉抽搐等。\n\n为了确定患者是否患有癫痫，需要进行一系列检查。以下是一些常见的检查方法：\n\n1. 脑电图(EEG)：脑电图是通过患者头部的电极记录大脑神经元的电活动，是确定癫痫发作类型的重要方法之一。\n\n2. 核磁共振(MRI):MRI可以提供大脑的详细图像，帮助医生确定癫痫灶的位置和类型。\n\n3. 视觉记录(Visual记录)：该方法使用一种特殊的眼镜，记录患者的视觉信息，从而进行癫痫发作的评估。\n\n4. 视频脑电图(VEEG)：视频脑电图和视觉记录类似，但可以记录大脑神经元的电活动，同时使用摄像头记录患者的视觉信息。\n\n5. 癫痫发作日志：患者需要记录自己的癫痫发作情况，医生可以对患者的日志进行分析，以确定是否存在癫痫发作类型。\n\n6. 影像学检查(如CT、MRI、PET)：这些检查可以帮助医生确定癫痫灶的位置和类型，同时也可以用于癫痫的治疗决策。\n\n以上是一些常见的癫痫检查方法，医生会根据患者的具体情况选择最合适的检查方法。"
    },
    "1": {
        "question": "儿子头痛会不会是生长痛",
        "response": "儿子头痛的原因有很多，不仅仅是生长痛。生长痛是指在儿童期，由于身体不断生长和发育而引起的头痛。这种头痛通常会在儿童期消失，不需要特殊治疗。\n\n除了生长痛外，儿子头痛的原因可能还包括其他因素，例如睡眠不足、紧张、压力、感冒等等。如果怀疑儿子可能有头痛，建议他去看医生或儿科医生，进行诊断和治疗。医生可能会对儿子进行必要的检查，例如测量血压和脑电图等，以确定头痛的原因。"
    },
    "2": {
        "question": "宝宝病毒性感冒吃药后恶心呕吐要如何解决",
        "response": "宝宝病毒性感冒后，有些药物可能会引起药物不良反应，包括呕吐。如果注意到宝宝吃药后出现了呕吐症状，以下是一些可能的解决方案：\n1. 暂停药物：在宝宝出现呕吐症状之前，先暂停药物。如果呕吐症状已经减轻或消失了，可以继续服用药物，但是需要根据医生的建议来确定是否继续服用药物。\n2. 改变药物种类：有些药物可能会引起宝宝的呕吐症状，可以尝试更换其他药物种类。例如，一些抗病毒药物可能会引起宝宝的恶心和呕吐，可以尝试使用其他药物来缓解症状。\n3. 使用轻口味药物：使用轻口味药物，如儿童退烧药或非处方药，可能会减少宝宝的呕吐症状。\n4. 喝水：多喝水可以帮助宝宝缓解药物不良反应，也可以促进药物的吸收。\n5. 咨询医生：如果呕吐症状持续或加重，或者宝宝出现其他症状，如腹泻、发热等，需要咨询医生的建议，根据医生的建议调整药物和治疗方案。"
    },
    "3": {
        "question": "脑囊虫要是引起的癫痫怎么治疗？",
        "response": "脑囊虫引起的癫痫的治疗取决于癫痫的类型、发作的严重程度以及患者的年龄和健康状况等因素。以下是一些可能的治疗方法：\n\n1.药物治疗：药物治疗是脑囊虫引起的癫痫的常见治疗方法。抗癫痫药物可以通过口服或注射的方式使用，但需要根据患者的具体情况进行个性化的药物选择和剂量设计。一些药物可能的副作用包括肝脏损伤、肾脏损伤和药物相互作用等问题，因此需要医生的专业意见。\n\n2.手术治疗：手术治疗通常用于治疗癫痫发作的脑囊虫感染，例如清除脑内虫子或预防虫子再次感染。手术的方法包括脑电图和脑囊虫扫描等，这些技术可以帮助医生确定感染的位置和严重程度，以及帮助医生进行虫子清除或预防感染的手术。\n\n3.抗癫痫药物替代疗法：对于某些癫痫类型，抗癫痫药物可能无法缓解症状，此时可以使用其他药物替代疗法，例如抗抑郁药、抗焦虑药、类固醇等。\n\n针对脑囊虫引起的癫痫，需要根据患者的具体情况进行个性化的治疗方案设计，包括药物治疗、手术治疗和抗癫痫药物替代疗法等。治疗方案需要根据患者的具体情况进行个性化的制定，因此建议患者咨询专业医生的意见。"
    },
    "4": {
        "question": "女性癫痫属遗传疾病的一种吗？",
        "response": "女性癫痫是遗传疾病的一种。女性癫痫可能与遗传基因有关，而男性癫痫则可能由其他因素引起。虽然女性癫痫的遗传风险与男性相似，但每个个体的风险和遗传基因型都是不同的。此外，女性癫痫患者的父亲可能携带某些基因，使其女儿也患上癫痫。\n\n虽然遗传基因是引起女性癫痫的其中一个因素，但现代研究也表明，环境因素也可能对癫痫的发生起到重要作用，如头部创伤、感染、药物不良反应、脑电图异常等。因此，对于女性癫痫患者，需要根据个体情况，综合考虑遗传和环境因素，以制定最佳的治疗计划。"
    },
    "5": {
        "question": "想知道癫痫能否缓解吗？",
        "response": "癫痫是一种神经系统疾病，其症状包括突然的发作和脑电图异常。虽然癫痫发作可以通过药物治疗和手术治疗来控制，但癫痫发作本身并不是完全可控制的。\n\n一些癫痫发作可以通过药物治疗来控制，这些药物可以抑制癫痫发作的脑电图异常，但是并不能完全消除这种异常。另外，一些人可能需要长期的药物治疗才能控制癫痫发作，而且药物治疗可能会带来一些副作用，如头晕、恶心、肝脏损伤等。\n\n除了药物治疗外，一些人可能需要手术治疗，如定位性癫痫手术或针对癫痫发作的修复手术，这些手术可以帮助消除或减少癫痫发作的脑电图异常。\n\n虽然一些癫痫发作可以通过药物治疗或手术治疗来控制，但并不能完全消除这种异常。因此，对于癫痫患者，最好的方法是通过药物治疗和定期的脑电图检查来减少癫痫发作的频率和幅度，同时避免任何副作用。"
    }
# TODO
- 降低显存使用
- 多轮对话
